<!DOCTYPE html>
<html class="scroll-smooth" data-auto-appearance="false" data-default-appearance="dark" dir="ltr" lang="CN"><head>
<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?f260c483ac9fab4fdd9fd55057878c8c";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
<meta charset="utf-8"/>
<meta content="zh-cn" http-equiv="content-language"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="ie=edge" http-equiv="X-UA-Compatible"/>
<title>IoT基础学习 · ta0lve</title>
<meta content="IoT基础学习 · ta0lve" name="title"/>
<meta content="IoT, " name="keywords"/>
<link href="https://ta0lve.github.io/posts/iot/0x01/" rel="canonical"/>
<link href="/css/main.bundle.min.c6116b9ed1c907a8c0eb015f377d3eecc07e448d75729e31fc3de5881465c6c172ba9fa9a6800c030116caf2a110d92242bb816639484ca791f7cd107a8d49b5.css" integrity="sha512-xhFrntHJB6jA6wFfN30+7MB+RI11cp4x/D3liBRlxsFyup+ppoAMAwEWyvKhENkiQruBZjlITKeR980Qeo1JtQ==" rel="stylesheet" type="text/css"/>
<script integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg==" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js" type="text/javascript"></script>
<script data-copied="" data-copy="" defer="" id="script-bundle" integrity="sha512-PdzwT1sNTDL3LnJtPBLuvM2MPJ+dqpoTQUgIiV3grh4c3d2mhJaA1b2W27YNCx4LJMKfXIPlYx5V5+a8AgFUkA==" src="/js/main.bundle.min.3ddcf04f5b0d4c32f72e726d3c12eebccd8c3c9f9daa9a13414808895de0ae1e1cdddda6849680d5bd96dbb60d0b1e0b24c29f5c83e5631e55e7e6bc02015490.js" type="text/javascript"></script>
<script src="/js/zoom.min.js"></script>
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"/>
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="/site.webmanifest" rel="manifest"/>
<meta content="IoT基础学习" property="og:title"/>
<meta content="如果本博客部分文章图片加载失败， 可以点击此处查看解决办法 固件" property="og:description"/>
<meta content="article" property="og:type"/>
<meta content="https://ta0lve.github.io/posts/iot/0x01/" property="og:url"/><meta content="https://ta0lve.github.io/posts/iot/0x01/featured.jpg" property="og:image"/><meta content="posts" property="article:section"/>
<meta content="2024-02-21T00:00:00+00:00" property="article:published_time"/>
<meta content="2024-02-23T00:00:00+00:00" property="article:modified_time"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="https://ta0lve.github.io/posts/iot/0x01/featured.jpg" name="twitter:image"/>
<meta content="IoT基础学习" name="twitter:title"/>
<meta content="如果本博客部分文章图片加载失败， 可以点击此处查看解决办法 固件" name="twitter:description"/>
<script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "IoT基础学习",
    "headline": "IoT基础学习",
    
    "abstract": "如果本博客部分文章图片加载失败， 可以点击此处查看解决办法 固件",
    "inLanguage": "zh-cn",
    "url" : "https:\/\/ta0lve.github.io\/posts\/iot\/0x01\/",
    "author" : {
      "@type": "Person",
      "name": "ta0lve"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-02-21T00:00:00\u002b00:00",
    "datePublished": "2024-02-21T00:00:00\u002b00:00",
    
    "dateModified": "2024-02-23T00:00:00\u002b00:00",
    
    "keywords": ["IoT"],
    
    "mainEntityOfPage": "true",
    "wordCount": "6165"
  }]
  </script>
<meta content="ta0lve" name="author"/>
<link href="mailto:hujt25@mail2.sysu.edu.cn" rel="me"/>
<link href="https://ta0lve.github.io/" rel="me"/>
<link href="https://github.com/ta0lve" rel="me"/>
<script integrity="" src="/lib/jquery/jquery.slim.min.js"></script>
<meta name="theme-color"/>
</head>
<body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32">
<div class="absolute flex self-center" id="the-top">
<a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href="#main-content"><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">↓</span></a>
</div>
<div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
<div class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl" id="menu-blur"></div>
<div class="relative max-w-[64rem] ml-auto mr-auto">
<div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3" style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px">
<div class="flex flex-1 items-center justify-between">
<nav class="flex space-x-3">
<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/">ta0lve</a>
</nav>
<nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">
<a class="flex items-center" href="/posts/">
<p class="text-base font-medium text-gray-500 hover:text-gray-900" title="Posts">
        Posts
    </p>
</a>
<a class="flex items-center" href="/categories/">
<p class="text-base font-medium text-gray-500 hover:text-gray-900" title="Categories">
        分类
    </p>
</a>
<a class="flex items-center" href="/tags/">
<p class="text-base font-medium text-gray-500 hover:text-gray-900" title="Tags">
        标签
    </p>
</a>
<a class="flex items-center" href="/link/">
<p class="text-base font-medium text-gray-500 hover:text-gray-900" title="友链/links">
        友链
    </p>
</a>
<a class="flex items-center" href="/about/">
<p class="text-base font-medium text-gray-500 hover:text-gray-900" title="About">
        About
    </p>
</a>
<button aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400 h-12" id="search-button" title="">
<span class="relative block icon">
<svg aria-hidden="true" class="svg-inline--fa fa-search fa-w-16" data-icon="search" data-prefix="fas" focusable="false" role="img" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z" fill="currentColor"></path></svg>
</span>
</button>
<div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400">
<button aria-label="Dark mode switcher" id="appearance-switcher" type="button">
<div class="flex items-center justify-center h-12 dark:hidden">
<span class="relative block icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z" fill="currentColor"></path></svg>
</span>
</div>
<div class="items-center justify-center hidden h-12 dark:flex">
<span class="relative block icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z" fill="currentColor"></path></svg>
</span>
</div>
</button>
</div>
</nav>
<div class="flex md:hidden items-center space-x-5 md:ml-12">
<span></span>
<button aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400" id="search-button-mobile" title="">
<span class="relative block icon">
<svg aria-hidden="true" class="svg-inline--fa fa-search fa-w-16" data-icon="search" data-prefix="fas" focusable="false" role="img" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z" fill="currentColor"></path></svg>
</span>
</button>
<button aria-label="Dark mode switcher" id="appearance-switcher-mobile" style="margin-right:5px" type="button">
<div class="flex items-center justify-center h-12 dark:hidden">
<span class="relative block icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z" fill="currentColor"></path></svg>
</span>
</div>
<div class="items-center justify-center hidden h-12 dark:flex">
<span class="relative block icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z" fill="currentColor"></path></svg>
</span>
</div>
</button>
</div>
</div>
<div class="-my-2 -mr-2 md:hidden">
<label class="block" for="menu-controller" id="menu-button">
<input class="hidden" id="menu-controller" type="checkbox"/>
<div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
<span class="relative block icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z" fill="currentColor"></path></svg>
</span>
</div>
<div class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50" id="menu-wrapper" style="padding-top:5px;">
<ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">
<li>
<span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
<span class="relative block icon">
<svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z" fill="currentColor"></path></svg>
</span>
</span>
</li>
<li class="mt-1">
<a class="flex items-center" href="/posts/">
<p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="Posts">
            Posts
        </p>
</a>
</li>
<li class="mt-1">
<a class="flex items-center" href="/categories/">
<p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="Categories">
            分类
        </p>
</a>
</li>
<li class="mt-1">
<a class="flex items-center" href="/tags/">
<p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="Tags">
            标签
        </p>
</a>
</li>
<li class="mt-1">
<a class="flex items-center" href="/link/">
<p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="友链/links">
            友链
        </p>
</a>
</li>
<li class="mt-1">
<a class="flex items-center" href="/about/">
<p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="About">
            About
        </p>
</a>
</li>
</ul>
</div>
</label>
</div>
</div>
<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>
</div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>
<div class="relative flex flex-col grow">
<main class="grow" id="main-content">
<article>
<div class="h-[150px] md:h-[200px]" id="hero"></div>
<div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom" style="background-image:url(/posts/iot/0x01/featured.jpg);">
<div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
</div>
<div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
</div>
</div>
<div class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl" id="background-blur"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>
<header class="mt-5 max-w-prose" id="single_header">
<ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
<li class="inline hidden">
<a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href="/"></a><span class="px-1 text-primary-500">/</span>
</li>
<li class="inline">
<a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href="/posts/">Posts</a><span class="px-1 text-primary-500">/</span>
</li>
<li class="inline hidden">
<a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href="/posts/iot/0x01/">IoT基础学习</a><span class="px-1 text-primary-500">/</span>
</li>
</ol>
<h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      IoT基础学习
    </h1>
<div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
<div class="flex flex-row flex-wrap items-center">
<time datetime="2024-02-21 00:00:00 +0000 UTC">February 21, 2024</time><span class="px-2 text-primary-500">·</span><time datetime="2024-02-23 00:00:00 +0000 UTC"></time><span class="px-2 text-primary-500">·</span><span>6165 字</span><span class="px-2 text-primary-500">·</span><span title="预计阅读">13 分钟</span>
</div>
<div class="flex flex-row flex-wrap items-center">
<span class="mr-2" onclick="window.open(&quot;/categories/iot%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    IoT学习记录
  </span>
</span>
</span>
<span class="mr-2" onclick="window.open(&quot;/tags/iot/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    IoT
  </span>
</span>
</span>
</div>
</div>
<div class="flex">
<div class="place-self-center">
<div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      作者
    </div>
<div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      ta0lve
    </div>
<div class="text-sm text-neutral-700 dark:text-neutral-400">一些记录，一点思考</div>
<div class="text-2xl sm:text-lg">
<div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
<a aria-label="Email" class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="mailto:hujt25@mail2.sysu.edu.cn" rel="me noopener noreferrer" target="_blank"><span class="inline-block align-text-bottom">
<span class="relative block icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z" fill="currentColor"></path></svg>
</span>
</span></a>
<a aria-label="Blogger" class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://ta0lve.github.io/" rel="me noopener noreferrer" target="_blank"><span class="inline-block align-text-bottom">
<span class="relative block icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M446.6 222.7c-1.8-8-6.8-15.4-12.5-18.5-1.8-1-13-2.2-25-2.7-20.1-.9-22.3-1.3-28.7-5-10.1-5.9-12.8-12.3-12.9-29.5-.1-33-13.8-63.7-40.9-91.3-19.3-19.7-40.9-33-65.5-40.5-5.9-1.8-19.1-2.4-63.3-2.9-69.4-.8-84.8.6-108.4 10C45.9 59.5 14.7 96.1 3.3 142.9 1.2 151.7.7 165.8.2 246.8c-.6 101.5.1 116.4 6.4 136.5 15.6 49.6 59.9 86.3 104.4 94.3 14.8 2.7 197.3 3.3 216 .8 32.5-4.4 58-17.5 81.9-41.9 17.3-17.7 28.1-36.8 35.2-62.1 4.9-17.6 4.5-142.8 2.5-151.7zm-322.1-63.6c7.8-7.9 10-8.2 58.8-8.2 43.9 0 45.4.1 51.8 3.4 9.3 4.7 13.4 11.3 13.4 21.9 0 9.5-3.8 16.2-12.3 21.6-4.6 2.9-7.3 3.1-50.3 3.3-26.5.2-47.7-.4-50.8-1.2-16.6-4.7-22.8-28.5-10.6-40.8zm191.8 199.8l-14.9 2.4-77.5.9c-68.1.8-87.3-.4-90.9-2-7.1-3.1-13.8-11.7-14.9-19.4-1.1-7.3 2.6-17.3 8.2-22.4 7.1-6.4 10.2-6.6 97.3-6.7 89.6-.1 89.1-.1 97.6 7.8 12.1 11.3 9.5 31.2-4.9 39.4z" fill="currentColor"></path></svg>
</span>
</span></a>
<a aria-label="Github" class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://github.com/ta0lve" rel="me noopener noreferrer" target="_blank"><span class="inline-block align-text-bottom">
<span class="relative block icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" fill="currentColor"></path></svg>
</span>
</span></a>
</div>
</div>
</div>
</div>
<div class="mb-5"></div>
</header>
<section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
<div class="order-first sm:max-w-prose lg:ml-auto px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8">
<div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">
<details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block" open="">
<summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
</summary>
<div class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<nav id="TableOfContents">
<ul>
<li><a href="#固件获取">固件获取</a>
<ul>
<li>
<ul>
<li><a href="#固件厂商官网">固件厂商官网</a></li>
<li><a href="#抓取更新包">抓取更新包</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#固件解密">固件解密</a></li>
<li><a href="#固件解包">固件解包</a>
<ul>
<li>
<ul>
<li><a href="#ubi">UBI</a></li>
<li><a href="#pfs">PFS</a></li>
<li><a href="#openwrt-lua">Openwrt Lua</a></li>
<li><a href="#u-boot">U-boot</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#固件打包">固件打包</a>
<ul>
<li>
<ul>
<li><a href="#替换启动脚本">替换启动脚本</a></li>
<li><a href="#交叉编译">交叉编译</a></li>
<li><a href="#firmware-mod-kit">firmware-mod-kit</a></li>
<li><a href="#手动分析">手动分析</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#固件仿真与fuzz">固件仿真与FUZZ</a>
<ul>
<li>
<ul>
<li><a href="#qemu">QEMU</a></li>
<li><a href="#unicorn">Unicorn</a></li>
<li><a href="#qiling">Qiling</a></li>
<li><a href="#firmadyne">Firmadyne</a></li>
<li><a href="#firmae">FirmAE</a></li>
<li><a href="#firmware-analysis-toolkit">Firmware Analysis Toolkit</a></li>
<li><a href="#firmafl">FirmAFL</a></li>
<li><a href="#firmfuzz">FirmFuzz</a></li>
<li><a href="#fuzzware">Fuzzware</a></li>
<li><a href="#afl">afl</a></li>
<li><a href="#alf">alf++</a></li>
<li><a href="#satc">SaTC</a></li>
<li><a href="#iotseccfuzz">iotseccfuzz</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#其他相关工具">其他相关工具</a></li>
<li><a href="#参考链接">参考链接</a></li>
</ul>
</nav>
</div>
</details>
<details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
<summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
</summary>
<div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<nav id="TableOfContents">
<ul>
<li><a href="#固件获取">固件获取</a>
<ul>
<li>
<ul>
<li><a href="#固件厂商官网">固件厂商官网</a></li>
<li><a href="#抓取更新包">抓取更新包</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#固件解密">固件解密</a></li>
<li><a href="#固件解包">固件解包</a>
<ul>
<li>
<ul>
<li><a href="#ubi">UBI</a></li>
<li><a href="#pfs">PFS</a></li>
<li><a href="#openwrt-lua">Openwrt Lua</a></li>
<li><a href="#u-boot">U-boot</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#固件打包">固件打包</a>
<ul>
<li>
<ul>
<li><a href="#替换启动脚本">替换启动脚本</a></li>
<li><a href="#交叉编译">交叉编译</a></li>
<li><a href="#firmware-mod-kit">firmware-mod-kit</a></li>
<li><a href="#手动分析">手动分析</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#固件仿真与fuzz">固件仿真与FUZZ</a>
<ul>
<li>
<ul>
<li><a href="#qemu">QEMU</a></li>
<li><a href="#unicorn">Unicorn</a></li>
<li><a href="#qiling">Qiling</a></li>
<li><a href="#firmadyne">Firmadyne</a></li>
<li><a href="#firmae">FirmAE</a></li>
<li><a href="#firmware-analysis-toolkit">Firmware Analysis Toolkit</a></li>
<li><a href="#firmafl">FirmAFL</a></li>
<li><a href="#firmfuzz">FirmFuzz</a></li>
<li><a href="#fuzzware">Fuzzware</a></li>
<li><a href="#afl">afl</a></li>
<li><a href="#alf">alf++</a></li>
<li><a href="#satc">SaTC</a></li>
<li><a href="#iotseccfuzz">iotseccfuzz</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#其他相关工具">其他相关工具</a></li>
<li><a href="#参考链接">参考链接</a></li>
</ul>
</nav>
</div>
</details>
<script>
  (function () {
    var $toc = $('#TableOfContents');
    if ($toc.length > 0) {
      var $window = $(window);

      function onScroll() {
        var currentScroll = $window.scrollTop();
        var h = $('.anchor');
        var id = "";
        h.each(function (i, e) {
          e = $(e);
          if (e.offset().top - $(window).height()/3 <= currentScroll) {
            id = e.attr('id');
          }
        });
        var active = $toc.find('a.active');      
        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

        active.each(function (i, e) {
          
            $(e).removeClass('active');
          
        });
        $toc.find('a[href="#' + id + '"]').addClass('active')
        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
          $(e).children('a').parents('ul').show();          
        });
      }

      $window.on('scroll', onScroll);
      $(document).ready(function () {
        
        onScroll();
      });
    }
  })();
</script>
</div>
</div>
<div class="min-w-0 min-h-0 max-w-prose">
<details class="mt-2 mb-5 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5" open="" style="margin-left:0px">
<summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">
        IoT学习小记 - This article is part of a series.
    </summary>
<div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        Part 1: This Article
    </div>
<div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<a href="https://ta0lve.github.io/posts/iot/0x02/">
            Part 2: IoT漏洞复现记录
        </a>
</div>
<div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<a href="https://ta0lve.github.io/posts/iot/0x03/">
            Part 3: IoT漏洞挖掘思路
        </a>
</div>
</details>
<div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900">
<span class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center">
<span class="relative block icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z" fill="currentColor"></path></svg>
</span>
</span>
<span class="dark:text-neutral-300"><strong>如果本博客部分文章图片加载失败，</strong><a href="/posts/sth/sm.ms/">
<strong>可以点击此处查看解决办法</strong></a></span>
</div>
<div class="anchor" id="固件获取"></div>
<h2 class="relative group">固件获取 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e5%9b%ba%e4%bb%b6%e8%8e%b7%e5%8f%96" style="text-decoration-line: none !important;">#</a></span>
</h2>
<div class="anchor" id="固件厂商官网"></div>
<h4 class="relative group">固件厂商官网 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e5%9b%ba%e4%bb%b6%e5%8e%82%e5%95%86%e5%ae%98%e7%bd%91" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>一些国内路由器厂商的固件下载链接：</p>
<ul>
<li><a href="http://www.totolink.net/" target="_blank">
    totolink</a></li>
<li><a href="https://app.hiwifi.com/dstore.php?m=download&amp;a=info" target="_blank">
    极路由/hiwifi</a></li>
<li><a href="ftp://ftp2.dlink.com/PRODUCTS">
    D-LINK</a></li>
<li><a href="https://service.fastcom.com.cn/download-list.html#0" target="_blank">
    FAST</a></li>
<li><a href="https://www.tp-link.com/zh-hk/support/download/" target="_blank">
    TP-LINK</a></li>
<li><a href="https://service.mercurycom.com.cn/download-list.html" target="_blank">
    MERCURY</a></li>
<li><a href="https://www.tenda.com.cn/download/cata-11.html" target="_blank">
    Tenda</a></li>
<li><a href="http://www.netcoretec.com/download.html" target="_blank">
    磊科</a></li>
<li><a href="http://www.wayos.com/download/luyougujian.html" target="_blank">
    维盟</a></li>
<li><a href="https://www.utt.com.cn/downloadcenter.php" target="_blank">
    艾泰</a></li>
<li><a href="http://www.ruijie.com.cn/fw/rj/" target="_blank">
    锐捷</a></li>
<li><a href="http://www.adslr.com/companyfile/2/" target="_blank">
    飞鱼星</a></li>
<li><a href="http://www.newifi.com/download.shtml" target="_blank">
    newifi</a></li>
<li><a href="http://www.b-link.net.cn/download.php?CateId=11" target="_blank">
    b-link</a></li>
<li><a href="https://www.asus.com.cn/support/Download-Center/" target="_blank">
    华硕</a></li>
<li><a href="https://www.tenda.com.cn/download/cata-11.html" target="_blank">
    腾达</a></li>
<li><a href="http://www.tuoshi.cn/download.asp" target="_blank">
    拓实</a></li>
<li><a href="http://www.netis-systems.com/Suppory/de_details/id/1/de/50.html" target="_blank">
    netis</a></li>
<li><a href="https://www.asus.com.cn/Networking/RTAC68U/HelpDesk_BIOS/" target="_blank">
    华硕</a></li>
</ul>
<div class="anchor" id="抓取更新包"></div>
<h4 class="relative group">抓取更新包 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e6%8a%93%e5%8f%96%e6%9b%b4%e6%96%b0%e5%8c%85" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>wireshark配合热点抓设备升级的包</p>
<ul>
<li>工具：wireshark、ettercap</li>
<li>流程：中间人-&gt;开始抓包-&gt;在线升级-&gt;分析固件地址-&gt;下载</li>
<li>案例：</li>
</ul>
<p>华为路由WS5200 四核版这款路由器在网上找不到现有固件，我们尝试一下是否可以通过抓包在线升级过程获取固件。首先关闭防火墙，否则无法访问路由器的服务，无法做中间人攻击。使用ettercap进行arp欺骗，<code>sudo ettercap -Tq -i ens33 -M arp:remote /192.168.31.1// /192.168.31.134//</code>打开wireshark进行抓包。理论上说，点击升级固件之后，wireshark就能够记录升级固件的整个过程(HTTP),但是结果却并不理想。</p>
<p>还好华为路由器自带了抓包的功能（方便后期的调试和维护），所以直接使用这个功能抓取报文，比做中间人要直接了当得多。</p>
<p>在点击升级固件之后，我们可以看到大量发往58.49.156.104这个地址的报文，猜测极有可能是华为的服务器，过滤一下会看得更清楚可以看到在通过三次TCP握手之后，华为路由器向服务器发送了get请求，uri就是获取固件的地址：<a href="http://update.hicloud.com/TDS/data/files/p14/s145/G4404/g1810/v272964/f1/WS5200_10.0.2.7_main.bin" target="_blank">
<code>http://update.hicloud.com/TDS/data/files/p14/s145/G4404/g1810/v272964/f1/WS5200_10.0.2.7_main.bin</code></a></p>
<p>点击即可拿到最新的固件</p>
<hr/>
<p>还可以用<strong>burpsuite</strong>来抓取APP请求设备升级的包</p>
<div class="anchor" id="固件解密"></div>
<h2 class="relative group">固件解密 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e5%9b%ba%e4%bb%b6%e8%a7%a3%e5%af%86" style="text-decoration-line: none !important;">#</a></span>
</h2>
<p>参考链接：</p>
<p><a href="https://wokough.gitbook.io/iot-firmware-aio/wiki/gu-jian-jie-mi#yi-gu-jian-jia-mi-pan-duan" target="_blank">
    固件解密 - IOT 固件安全 All in One (gitbook.io)</a></p>
<ul>
<li>可以先上网查询有没有相关文章</li>
<li>也可以看一下同一品牌的其他固件是如何解密的</li>
</ul>
<p>解密固件是分析加密固件所需迈过的第一道坎</p>
<p>部分固件的解密思路还可以参考以下思路：</p>
<p>看看是不是仍有少部分固件（或过渡版本的固件）并未加密，当这些固件升级的过程中大概也会使用到解密的程序，因此可以<strong>通过解开这些未加密固件，找到解密程序，并逆向分析出相关算法</strong>，这也是固件解密常用的一种手段。并且，一般一个厂商的固件加密算法都是相同的，这样所有的固件我们都能够解开了</p>
<p>解密完固件为后续的静态分析做准备</p>
<div class="anchor" id="固件解包"></div>
<h2 class="relative group">固件解包 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e5%9b%ba%e4%bb%b6%e8%a7%a3%e5%8c%85" style="text-decoration-line: none !important;">#</a></span>
</h2>
<p>初入IOT安全研究时，对于大部分固件直接<code>binwalk -Me</code>就可以了</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">binwalk -Me *.bin
</span></span></code></pre></div><p>对文件夹重新打包成zip，从linux下转到windows下源码审计</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">zip -r -q -o pack.zip test/
</span></span><span class="line"><span class="cl">cp ./pack.zip /mnt/hgfs/share
</span></span></code></pre></div><hr/>
<p>以下介绍几种需要绕点弯的情况</p>
<div class="anchor" id="ubi"></div>
<h4 class="relative group">UBI 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#ubi" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>(Unsorted Block Image)</p>
<p>UBI格式的固件算比较常见的，binwalk并不能直接解包，但是github上有现成的工具<a href="https://github.com/jrspruitt/ubi_reader" target="_blank">
    ubi_reader</a></p>
<p>UBI_reader解包，UBI文件必须是1024bytes的整数倍，需要增删内容对齐，比如通过分析某路由器，发现其rootfs是UBI格式：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># binwalk ROM/wifi_firmware_c91ea_1.0.50.bin</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">--------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">684</span>           0x2AC           UBI erase count header, version: 1, EC: 0x0, VID header offset: 0x800, data offset: 0x1000
</span></span></code></pre></div><p>首先安装ubi_reader：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ sudo apt-get install liblzo2-dev
</span></span><span class="line"><span class="cl">$ sudo pip install python-lzo
</span></span><span class="line"><span class="cl">$ git clone &lt;https://github.com/jrspruitt/ubi_reader&gt;
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> ubi_reader
</span></span><span class="line"><span class="cl">$ sudo python setup.py install
</span></span></code></pre></div><p>或者直接<code>$ sudo pip install ubi_reader</code> 然后将根据地址将UBI结构提取出来，利用<code>ubireader_extract_files [options] path/to/file</code> 即可解包</p>
<div class="anchor" id="pfs"></div>
<h4 class="relative group">PFS 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#pfs" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>运行binwalk后查看结果，发现没有发现任何可识别的东西，此时可以手动分析或者去搜索一些相关工具。 这里在github上找到<a href="https://github.com/gerard-/draytools" target="_blank">
    相关工具</a>，直接根据提示使用命令就可解开固件</p>
<p>简单看一下固件解包关键代码，关键在于找到类似’\xA5\xA5\xA5\x5A\xA5\x5A’的header，之后根据具体格式解包解压即可，所以固件解包说到底还是数据格式分析</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decompress_firmware</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">flen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">sigstart</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'</span><span class="se">\\</span><span class="s1">xA5</span><span class="se">\\</span><span class="s1">xA5</span><span class="se">\\</span><span class="s1">xA5</span><span class="se">\\</span><span class="s1">x5A</span><span class="se">\\</span><span class="s1">xA5</span><span class="se">\\</span><span class="s1">x5A'</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">sigstart</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">sigstart</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'</span><span class="se">\\</span><span class="s1">x5A</span><span class="se">\\</span><span class="s1">x5A</span><span class="se">\\</span><span class="s1">xA5</span><span class="se">\\</span><span class="s1">x5A</span><span class="se">\\</span><span class="s1">xA5</span><span class="se">\\</span><span class="s1">x5A'</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">sigstart</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">draytools</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="nb">print</span> <span class="s1">'Signature found at [0x</span><span class="si">%08X</span><span class="s1">]'</span> <span class="o">%</span> <span class="n">sigstart</span>
</span></span><span class="line"><span class="cl">		<span class="n">lzosizestart</span> <span class="o">=</span> <span class="n">sigstart</span> <span class="o">+</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">		<span class="n">lzostart</span> <span class="o">=</span> <span class="n">lzosizestart</span> <span class="o">+</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">		<span class="n">lzosize</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">'&gt;L'</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">lzosizestart</span><span class="p">:</span><span class="n">lzostart</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="mh">0x100</span><span class="p">:</span><span class="n">sigstart</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> \\
</span></span><span class="line"><span class="cl">			<span class="o">+</span> <span class="n">pydelzo</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="s1">'</span><span class="se">\\</span><span class="s1">xF0'</span> <span class="o">+</span> <span class="n">pack</span><span class="p">(</span><span class="s2">"&gt;L"</span><span class="p">,</span><span class="mh">0x1000000</span><span class="p">)</span> \\
</span></span><span class="line"><span class="cl">				<span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="n">lzostart</span><span class="p">:</span><span class="n">lzostart</span><span class="o">+</span><span class="n">lzosize</span><span class="p">])</span>
</span></span></code></pre></div><p>之后可参考：</p>
<p><a href="https://wokough.gitbook.io/iot-firmware-aio/wiki/gu-jian-jie-pou#:~:text=%E5%8D%B3%E5%8F%AF%E8%A7%A3%E5%8C%85%E3%80%82-,PFS,-%E6%9C%89%E4%BA%9B%E5%9B%BA%E4%BB%B6" target="_blank">
    https://wokough.gitbook.io/iot-firmware-aio/wiki/gu-jian-jie-pou#:~:text=%E5%8D%B3%E5%8F%AF%E8%A7%A3%E5%8C%85%E3%80%82-,PFS,-%E6%9C%89%E4%BA%9B%E5%9B%BA%E4%BB%B6</a></p>
<div class="anchor" id="openwrt-lua"></div>
<h4 class="relative group">Openwrt Lua 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#openwrt-lua" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>可参考：</p>
<p><a href="https://wokough.gitbook.io/iot-firmware-aio/wiki/gu-jian-jie-pou#:~:text=...-,Openwrt%20Lua,-lua%E7%BB%93%E6%9E%84%E8%A7%A3%E6%9E%90" target="_blank">
    https://wokough.gitbook.io/iot-firmware-aio/wiki/gu-jian-jie-pou#:~:text=...-,Openwrt%20Lua,-lua%E7%BB%93%E6%9E%84%E8%A7%A3%E6%9E%90</a></p>
<div class="anchor" id="u-boot"></div>
<h4 class="relative group">U-boot 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#u-boot" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>RTOS（实时操作系统）</p>
<p>boot类的固件也是我们常会遇见的一类无文件系统固件，比如很多IOT设备会采用<a href="https://github.com/u-boot/u-boot" target="_blank">
    U-boot</a>作引导，因为U-boot开源，我们可以参照源代码分析，对于有些架构的U-boot也可以采用固定套路，比如mips可以根据$gp寄存器等</p>
<div class="anchor" id="固件打包"></div>
<h2 class="relative group">固件打包 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e5%9b%ba%e4%bb%b6%e6%89%93%e5%8c%85" style="text-decoration-line: none !important;">#</a></span>
</h2>
<div class="anchor" id="替换启动脚本"></div>
<h4 class="relative group">替换启动脚本 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e6%9b%bf%e6%8d%a2%e5%90%af%e5%8a%a8%e8%84%9a%e6%9c%ac" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>一般将交叉编译好的telnetd，dropbear(sshd)，gdb放入固件文件，再替换启动脚本打包。 linux的启动脚本套路众多，尤其在IOT设备中，所以可以采用比较巧妙的方法，比如确定/sbin/xxxd服务会开机运行，可以将其替换</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># mv rootfs/sbin/xxxd sbin/xxxdd</span>
</span></span><span class="line"><span class="cl"><span class="c1"># touch rootfs/sbin/xxxd</span>
</span></span><span class="line"><span class="cl"><span class="c1"># chmod +x rootfs/sbin/xxxd</span>
</span></span></code></pre></div><p>之后在sbin/xxxd添加</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"> <span class="c1">#!/bin/sh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/usr/sbin/telnetd -F -l /bin/sh -p <span class="m">1234</span> <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">/sbin/xxxdd <span class="p">&amp;</span>
</span></span></code></pre></div><div class="anchor" id="交叉编译"></div>
<h4 class="relative group">交叉编译 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e4%ba%a4%e5%8f%89%e7%bc%96%e8%af%91" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>如果能从正向开发角度来打包当然最方便，也就是交叉编译的事。笔者研究过的一些设备中，主要是路由器固件会部分遵循<a href="https://www.gnu.org/licenses/gpl-3.0.txt" target="_blank">
    GPL</a>，就是开源一部分代码软件(一般本来就是基于开源工具)，并提供剩下软件的二进制文件和整个固件的打包工具(方法)</p>
<p>下载该zip包，根据自己的需求编译rootfs，最后利用zip包中自带的工具打包</p>
<div class="anchor" id="firmware-mod-kit"></div>
<h4 class="relative group">firmware-mod-kit 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#firmware-mod-kit" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>firmware-mod-kit(<a href="https://github.com/mirror/firmware-mod-kit" target="_blank">
    fmk</a>)可能是最常用的基于binwalk的解打包工具，但是由于很久没用更新，使用场景有限。</p>
<p>fmk的安装使用如下所示：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># For ubuntu</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ sudo apt-get install git build-essential zlib1g-dev liblzma-dev python-magic bsdmainutils autoconf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># For redhat/centos</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ yum groupinstall <span class="s2">"Development Tools"</span>
</span></span><span class="line"><span class="cl">$ yum install git zlib1g-dev xz-devel python-magic zlib-devel util-linux
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 使用</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ ./extract-firmware.sh firmware.bin //解包
</span></span><span class="line"><span class="cl">$ cp new-telnetd fmk/rootfs/usr/sbin/telnetd //按需修改
</span></span><span class="line"><span class="cl">$ ./build-firmware.sh //打包
</span></span></code></pre></div><div class="anchor" id="手动分析"></div>
<h4 class="relative group">手动分析 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e6%89%8b%e5%8a%a8%e5%88%86%e6%9e%90" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>打包的难度在于固件要与原固件一致，并通过各种校验，否则轻则刷机失败，重则设备变砖。</p>
<ul>
<li>有一篇关于netgear upnp漏洞的文章，可以看一下netgear固件打包过程
<ul>
<li><a href="https://www.freebuf.com/vuls/228293.html" target="_blank">
    Netgear R6400 upnp栈溢出漏洞分析 - FreeBuf网络安全行业门户</a></li>
</ul>
</li>
</ul>
<p>固件一般会分成许多section，为了方便解析，每个section会有指示头，头中可能会存放标志、大小和crc校验等信息，这些信息都为解打包提供依据。</p>
<p>比如可以先获取固件大小(十六进制)，根据固件大小端拆分字节，一般是4字节，然后在固件头上寻找类似字节(固件头上的指示长度会减去头长度)，接着从指示大小的字节往后分析就可以澄清格式，和分析网络协议的过程很像。</p>
<div class="anchor" id="固件仿真与fuzz"></div>
<h2 class="relative group">固件仿真与FUZZ 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e5%9b%ba%e4%bb%b6%e4%bb%bf%e7%9c%9f%e4%b8%8efuzz" style="text-decoration-line: none !important;">#</a></span>
</h2>
<p>参考链接：</p>
<p><a href="https://zhuanlan.zhihu.com/p/146228197" target="_blank">
    路由器固件模拟环境搭建（超详细） - 知乎 (zhihu.com)</a></p>
<p><a href="https://ainnia.github.io/blog/2021/02/24/%e6%8f%ad%e7%a7%98%e5%ae%b6%e7%94%a8%e8%b7%af%e7%94%b1%e5%99%a80day%e6%bc%8f%e6%b4%9e%e6%8c%96%e6%8e%98%e6%8a%80%e6%9c%af-%e8%af%bb%e4%b9%a6%e7%ac%94%e8%ae%b0/" target="_blank">
    揭秘家用路由器0day漏洞挖掘技术——读书笔记 | Ainnia Blog</a></p>
<p><a href="https://wokough.gitbook.io/iot-firmware-aio/wiki/fang-zhen-fen-xi" target="_blank">
    仿真分析 - IOT 固件安全 All in One (gitbook.io)</a></p>
<div class="anchor" id="qemu"></div>
<h4 class="relative group">QEMU 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#qemu" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p><a href="https://wokough.gitbook.io/iot-firmware-aio/wiki/fang-zhen-fen-xi#id-1.1-qemu" target="_blank">
    https://wokough.gitbook.io/iot-firmware-aio/wiki/fang-zhen-fen-xi#id-1.1-qemu</a></p>
<p>具体问题具体分析</p>
<p>具体固件使用对应的命令进行仿真</p>
<ul>
<li>先上网搜索相关信息，看看有没有文章已经仿真过了</li>
<li>参考之前仿真设备的案例来试着仿真</li>
<li>如果都没有就需要我们参考着官方文档以及对固件的静态分析来自己调整命令
<ul>
<li>如果遇到一些参数实在没有办法满足时可以先跑起来</li>
<li>在动态调试的过程看是哪个汇编执行报错
<ul>
<li>再在IDA中进行合适的patch来使得固件可以成功仿真</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>例如当我们需要向<code>main</code>函数传递参数<code>argv</code>和设置环境变量时，可以先看看官方usage：</p>
<p>
<figure>
<img alt="image-20240224180845930" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/7mbfZXdNqunW1BP.png"/>
</figure>
</p>
<p>发现我们可以用<code>-0</code>选项传递第一个参数，用<code>-E</code>选项设置环境变量，用<code>-L</code>选项做到类似于更改根目录的效果，用<code>-strace</code>选项追踪程序执行时进程系统调用和所接收的信号，方便调试</p>
<div class="anchor" id="unicorn"></div>
<h4 class="relative group">Unicorn 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#unicorn" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>QEMU 提供了一个完整的仿真环境，既可以模拟硬件外设、整个系统，也可以模拟单个二进制程序。而 Unicorn 专注于 CPU 指令的仿真</p>
<p><a href="https://www.unicorn-engine.org/" target="_blank">
    Unicorn – The Ultimate CPU emulator (unicorn-engine.org)</a></p>
<ul>
<li>暂时未使用（咕）</li>
</ul>
<div class="anchor" id="qiling"></div>
<h4 class="relative group">Qiling 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#qiling" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>基于Unicorn的模拟器，可以作为IDA pro插件，也可以利用Qiling Unicornalf进行fuzz，还可以模拟IOT设备固件</p>
<p>可以直接用<code>pip3 install qiling</code>安装</p>
<p>以下是模拟<code>ARMj</code>架构路由器固件的部分代码：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">socket</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl"><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">".."</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">qiling</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">patcher</span><span class="p">(</span><span class="n">ql</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">nvram_listener</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_sandbox</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">rootfs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ql</span> <span class="o">=</span> <span class="n">Qiling</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">rootfs</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="s2">"debug"</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ql</span><span class="o">.</span><span class="n">add_fs_mapper</span><span class="p">(</span><span class="s2">"/dev/urandom"</span><span class="p">,</span><span class="s2">"/dev/urandom"</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ql</span><span class="o">.</span><span class="n">hook_address</span><span class="p">(</span><span class="n">patcher</span> <span class="p">,</span><span class="n">ql</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">elf_entry</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ql</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">nvram_listener_therad</span> <span class="o">=</span>  <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">nvram_listener</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">nvram_listener_therad</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_sandbox</span><span class="p">([</span><span class="s2">"rootfs/bin/httpd"</span><span class="p">],</span> <span class="s2">"rootfs"</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li>暂时未使用（咕）</li>
</ul>
<div class="anchor" id="firmadyne"></div>
<h4 class="relative group">Firmadyne 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#firmadyne" style="text-decoration-line: none !important;">#</a></span>
</h4>
<ul>
<li>基于Linux的固件的仿真</li>
</ul>
<p><a href="https://github.com/firmadyne/firmadyne" target="_blank">
    firmadyne/firmadyne: Platform for emulation and dynamic analysis of Linux-based firmware (github.com)</a></p>
<ul>
<li>成功概率较低，不常用</li>
</ul>
<div class="anchor" id="firmae"></div>
<h4 class="relative group">FirmAE 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#firmae" style="text-decoration-line: none !important;">#</a></span>
</h4>
<ul>
<li>成功概率较高（优于Firmadyne）
<ul>
<li>FirmAE significantly increases the emulation success rate (From <a href="https://github.com/firmadyne/firmadyne" target="_blank">
    Firmadyne</a>’s 16.28% to 79.36%)</li>
</ul>
</li>
</ul>
<ul>
<li><a href="https://www.52pojie.cn/thread-1572565-1-1.html" target="_blank">
    FirmAE及DlinkDIR320、600、645漏洞复现 - 『软件调试区』 - 吾爱破解 - LCG - LSG |安卓破解|病毒分析|www.52pojie.cn</a></li>
<li><a href="https://github.com/pr0v3rbs/FirmAE" target="_blank">
    pr0v3rbs/FirmAE: Towards Large-Scale Emulation of IoT Firmware for Dynamic Analysis (github.com)</a></li>
<li><a href="https://ftp.dlink.ru/pub/Router/DIR-645/Firmware/" target="_blank">
    Index of /pub/Router/DIR-645/Firmware (dlink.ru)</a></li>
</ul>
<p><strong>安装：</strong></p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">git clone --recursive https://github.com/pr0v3rbs/FirmAE
</span></span><span class="line"><span class="cl">./download.sh
</span></span><span class="line"><span class="cl">./install.sh
</span></span></code></pre></div><p><strong>使用：</strong></p>
<p>执行脚本</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">./init.sh
</span></span></code></pre></div><p>准备固件</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># 举例：</span>
</span></span><span class="line"><span class="cl">wget https://github.com/pr0v3rbs/FirmAE/releases/download/v1.0/DIR-868L_fw_revB_2-05b02_eu_multi_20161117.zip
</span></span></code></pre></div><p>检查仿真</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sudo ./run.sh -c &lt;brand&gt; &lt;firmware&gt;
</span></span></code></pre></div><p>分析目标固件</p>
<ul>
<li>分析模式使用 FirmAE 分析器</li>
</ul>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sudo ./run.sh -a &lt;brand&gt; &lt;firmware&gt;
</span></span></code></pre></div><ul>
<li>运行模式有助于测试 Web 服务或执行自定义分析器</li>
</ul>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sudo ./run.sh -r &lt;brand&gt; &lt;firmware&gt;
</span></span></code></pre></div><p>
<figure>
<img alt="image-20240225104426390" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/lVyRLeOhft6maq3.png"/>
</figure>
</p>
<div class="anchor" id="firmware-analysis-toolkit"></div>
<h4 class="relative group">Firmware Analysis Toolkit 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#firmware-analysis-toolkit" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p><a href="https://github.com/attify/firmware-analysis-toolkit" target="_blank">
    attify/firmware-analysis-toolkit: Toolkit to emulate firmware and analyse it for security vulnerabilities (github.com)</a></p>
<p>安装：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">git clone https://github.com/attify/firmware-analysis-toolkit
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> firmware-analysis-toolkit
</span></span><span class="line"><span class="cl">./setup.sh
</span></span></code></pre></div><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># fat.config</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>DEFAULT<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">sudo_password</span><span class="o">=</span>attify123
</span></span><span class="line"><span class="cl"><span class="nv">firmadyne_path</span><span class="o">=</span>/home/attify/firmadyne
</span></span></code></pre></div><p>使用：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">./fat.py &lt;firmware file&gt;
</span></span></code></pre></div><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ ./fat.py DIR-601_REVB_FIRMWARE_2.01.BIN 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                               __           _   
</span></span><span class="line"><span class="cl">                              / _<span class="p">|</span>         <span class="p">|</span> <span class="p">|</span>  
</span></span><span class="line"><span class="cl">                             <span class="p">|</span> <span class="p">|</span>_    __ _  <span class="p">|</span> <span class="p">|</span>_ 
</span></span><span class="line"><span class="cl">                             <span class="p">|</span>  _<span class="p">|</span>  / _<span class="sb">`</span> <span class="p">|</span> <span class="p">|</span> __<span class="p">|</span>
</span></span><span class="line"><span class="cl">                             <span class="p">|</span> <span class="p">|</span>   <span class="p">|</span> <span class="o">(</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>_ 
</span></span><span class="line"><span class="cl">                             <span class="p">|</span>_<span class="p">|</span>    <span class="se">\_</span>_,_<span class="p">|</span>  <span class="se">\_</span>_<span class="p">|</span>                    
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                Welcome to the Firmware Analysis Toolkit - v0.3
</span></span><span class="line"><span class="cl">    Offensive IoT Exploitation Training http://bit.do/offensiveiotexploitation
</span></span><span class="line"><span class="cl">                  By Attify - https://attify.com  <span class="p">|</span> @attifyme
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Firmware: DIR-601_REVB_FIRMWARE_2.01.BIN
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Extracting the firmware...
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Image ID: <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Identifying architecture...
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Architecture: mipseb
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Building QEMU disk image...
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Setting up the network connection, please standby...
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Network interfaces: <span class="o">[(</span><span class="s1">'br0'</span>, <span class="s1">'192.168.0.1'</span><span class="o">)]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> All set! Press ENTER to run the firmware...
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> When running, press Ctrl + A X to terminate qemu
</span></span></code></pre></div><p>
<figure>
<img alt="image-20240223021726180" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/89ihSOXJv4ge1KF.png"/>
</figure>
</p>
<div class="anchor" id="firmafl"></div>
<h4 class="relative group">FirmAFL 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#firmafl" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p><a href="https://github.com/zyw-200/FirmAFL" target="_blank">
    zyw-200/FirmAFL: FIRM-AFL is the first high-throughput greybox fuzzer for IoT firmware. (github.com)</a></p>
<p><a href="https://blog.csdn.net/weixin_43695001/article/details/123486237" target="_blank">
    论文FirmAFL固件模糊测试工具——复现之路-CSDN博客</a></p>
<p>使用并改进了Firmdyne模拟方式，并利用AFL对IoT固件实施高通量灰盒Fuzzing</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># 编译用户模式</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ./FirmAFL/user_mode/
</span></span><span class="line"><span class="cl">sed -i <span class="s1">'40s/static //'</span> util/memfd.c
</span></span><span class="line"><span class="cl">./configure --target-list<span class="o">=</span>mipsel-linux-user,mips-linux-user,arm-linux-user --static --disable-werror
</span></span><span class="line"><span class="cl">make
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 编译系统模式</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ../qemu_mode/DECAF_qemu_2.10/
</span></span><span class="line"><span class="cl">sed -i <span class="s1">'40s/static //'</span> util/memfd.c
</span></span><span class="line"><span class="cl">./configure --target-list<span class="o">=</span>mipsel-softmmu,mips-softmmu,arm-softmmu --disable-werror
</span></span><span class="line"><span class="cl">make
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 安装Firmadyne并设置数据库</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ../../
</span></span><span class="line"><span class="cl">sudo apt-get install busybox-static fakeroot git dmsetup kpartx netcat-openbsd nmap python-psycopg2 python3-psycopg2 snmp uml-utilities util-linux vlan
</span></span><span class="line"><span class="cl">git clone --recursive &lt;https://github.com/firmadyne/firmadyne.git&gt;
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ../FirmAFL/firmadyne
</span></span><span class="line"><span class="cl">sudo apt-get install postgresql
</span></span><span class="line"><span class="cl">sudo apt-get install libpq-dev
</span></span><span class="line"><span class="cl">dropdb -U firmadyne -h 127.0.0.1 firmware
</span></span><span class="line"><span class="cl">sudo -u postgres createuser -P firmadyne
</span></span><span class="line"><span class="cl">sudo -u postgres createdb -O firmadyne firmware
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> database
</span></span><span class="line"><span class="cl">cp /home/churchkm/Downloads/data.xz ./
</span></span><span class="line"><span class="cl">xz -d data.xz
</span></span><span class="line"><span class="cl">mv data schema
</span></span><span class="line"><span class="cl">chmod +x schema
</span></span><span class="line"><span class="cl">sudo -u postgres psql -d firmware &lt; ./schema
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 使用Firmadyne仿真固件</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ../
</span></span><span class="line"><span class="cl">sudo ./download.sh
</span></span><span class="line"><span class="cl">sed -i <span class="s1">'4s/#//'</span> firmadyne.config
</span></span><span class="line"><span class="cl">cp ../firmadyne_modify/makeImage.sh ./scripts/
</span></span><span class="line"><span class="cl">sudo ./sources/extractor/extractor.py -b dlink -sql 127.0.0.1 -np -nk <span class="s2">"../firmware/DIR-815_FIRMWARE_1.01.ZIP"</span> images
</span></span><span class="line"><span class="cl">sudo ./scripts/getArch.sh ./images/9050.tar.gz
</span></span><span class="line"><span class="cl">sudo ./scripts/makeImage.sh <span class="m">9050</span>
</span></span><span class="line"><span class="cl">sudo ./scripts/inferNetwork.sh <span class="m">9050</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 使用FirmAFL进行Fuzzing</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ../
</span></span><span class="line"><span class="cl">python3 FirmAFL_setup.py <span class="m">9050</span> mipsel
</span></span><span class="line"><span class="cl">cp ./FirmAFL_config/9050/run.sh ./image_9050/  <span class="c1">#即用FirmAFL_config中的run.sh替换image_9050中的run.sh</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> image_9050
</span></span><span class="line"><span class="cl">sudo ./run.sh
</span></span><span class="line"><span class="cl"><span class="c1"># 固件启动后，新终端下执行</span>
</span></span><span class="line"><span class="cl">python3 test.py
</span></span><span class="line"><span class="cl">sudo user.sh
</span></span></code></pre></div><div class="anchor" id="firmfuzz"></div>
<h4 class="relative group">FirmFuzz 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#firmfuzz" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p>FirmFuzz的使用侧重Fuzzing，固件解包可单独使用firmadyne extractor或者binwalk</p>
<p><a href="https://github.com/HexHive/FirmFuzz.git" target="_blank">
    https://github.com/HexHive/FirmFuzz.git</a></p>
<div class="anchor" id="fuzzware"></div>
<h4 class="relative group">Fuzzware 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#fuzzware" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p><a href="https://github.com/fuzzware-fuzzer/fuzzware" target="_blank">
    fuzzware-fuzzer/fuzzware: Fuzzware’s main repository. Start here to install. (github.com)</a></p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">git clone https://github.com/fuzzware-fuzzer/fuzzware.git
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo ./build_docker.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo ./run_docker.sh examples fuzzware pipeline --skip-afl-cpufreq pw-recovery/ARCH_PRO
</span></span><span class="line"><span class="cl">sudo ./run_docker.sh <span class="nb">test</span> fuzzware pipeline --skip-afl-cpufreq .
</span></span></code></pre></div><p>成功将固件跑起来：</p>
<p>
<figure>
<img alt="image-20240202005856817" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/HWrN2XOmQKhB85P.png"/>
</figure>
</p>
<p>由图可以看到刚开始运行时发现新的MMIO寄存器模型，由于MMIO Access Model中并不存在，因此会将其定义为新的模型，然后继续向下运行</p>
<p>
<figure>
<img alt="image-20240202010428350" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/rhabIA2ZzgkHCeK.png"/>
</figure>
</p>
<p>建模完毕后，开始进行正常的fuzzing阶段：</p>
<p>
<figure>
<img alt="image-20240202011901838" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/5Q2ygtGMHwpCBUv.png"/>
</figure>
</p>
<p>每一轮fuzzing结束后，根据反馈调整输入，开始下一阶段fuzzing：</p>
<p>
<figure>
<img alt="image-20240202010524792" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/imqwHVTaQUobgF9.png"/>
</figure>
</p>
<div class="anchor" id="afl"></div>
<h4 class="relative group">afl 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#afl" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p><strong>安装</strong></p>
<ul>
<li>afl安装会报错，可以按照<a href="https://blog.csdn.net/qysh123/article/details/114792891" target="_blank">
    这篇博客</a>来修改：
<ul>
<li>不过我们可以安装的afl++</li>
<li>所以可以直接跳过afl部分</li>
</ul>
</li>
<li><a href="https://blog.csdn.net/qysh123/article/details/114792891" target="_blank">
    AFL（afl-qemu mode）的安装和使用（一）_afl qemu-CSDN博客</a>
<ul>
<li>afl安装</li>
</ul>
</li>
<li><a href="https://haoyep.com/posts/afl-install/" target="_blank">
    Ubuntu 22.04 安装 AFL 及 qemu mode 实践 | 云吱的小站 (haoyep.com)</a>
<ul>
<li>qemu模块的安装及无源码fuzz可以参考这篇文章</li>
</ul>
</li>
</ul>
<div class="anchor" id="alf"></div>
<h4 class="relative group">alf++ 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#alf" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p><a href="https://www.ruanx.net/afl-source-1/" target="_blank">
    AFL源码阅读（一）：启程 (ruanx.net)</a></p>
<div class="anchor" id="安装"></div>
<h5 class="relative group">安装： 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e5%ae%89%e8%a3%85" style="text-decoration-line: none !important;">#</a></span>
</h5>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sudo apt-get update
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo apt-get install -y build-essential python3-dev automake git flex bison libglib2.0-dev libpixman-1-dev python3-setuptools
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo apt-get install -y lld-11 llvm-11 llvm-11-dev clang-11 <span class="o">||</span> sudo apt-get install -y lld llvm llvm-dev clang
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo apt-get install -y gcc-<span class="k">$(</span>gcc --version<span class="p">|</span>head -n1<span class="p">|</span>sed <span class="s1">'s/.* //'</span><span class="p">|</span>sed <span class="s1">'s/\..*//'</span><span class="k">)</span>-plugin-dev libstdc++-<span class="k">$(</span>gcc --version<span class="p">|</span>head -n1<span class="p">|</span>sed <span class="s1">'s/.* //'</span><span class="p">|</span>sed <span class="s1">'s/\..*//'</span><span class="k">)</span>-dev
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> <span class="nv">$HOME</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git clone https://github.com/AFLplusplus/AFLplusplus <span class="o">&amp;&amp;</span> <span class="nb">cd</span> AFLplusplus
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LLVM_CONFIG</span><span class="o">=</span><span class="s2">"llvm-config-11"</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">make distrib
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo make install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># export CC=/home/closure/AFLplusplus/afl-clang-fast</span>
</span></span><span class="line"><span class="cl"><span class="c1"># export CXX=/home/closure/AFLplusplus/afl-clang-fast++</span>
</span></span><span class="line"><span class="cl"><span class="c1"># export LLVM_CONFIG="llvm-config-11"</span>
</span></span></code></pre></div><div class="anchor" id="使用"></div>
<h5 class="relative group"><strong>使用：</strong>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e4%bd%bf%e7%94%a8" style="text-decoration-line: none !important;">#</a></span>
</h5>
<p>使用 afl-gcc 进行插桩编译：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">afl-gcc test.c -o test_file
</span></span><span class="line"><span class="cl">gcc test.c -o test_gcc
</span></span></code></pre></div><ul>
<li>afl-gcc 插桩编译后，fuzz 的速度会快一些</li>
</ul>
<p>接下来就可以进行 fuzz 了：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">afl-fuzz -i ./fuzz_in -o ./fuzz_out ./test_file -f
</span></span></code></pre></div><ul>
<li>fuzz_in 为语料库，可以直接使用 AFL 自带的 testcases</li>
<li>fuzz_out 就是输出的内容</li>
</ul>
<p>现在我们开始 fuzz。首先利用 afl-clang-lto 编译一个有漏洞的代码<code>hello.c</code>。AFL++ 文档中有“如何选择编译器”的<a href="https://github.com/AFLplusplus/AFLplusplus/blob/stable/docs/fuzzing_in_depth.md#a-selecting-the-best-afl-compiler-for-instrumenting-the-target" target="_blank">
    指引</a>。我们手上的 llvm 版本大于 11，所以选择 LTO mode。</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">afl-gcc ./hello.c -o hello
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/home/iot/test/tools/AFLplusplus/afl-gcc ./hello.c -o hello
</span></span></code></pre></div><p>构造一些初始输入，放进 <code>inputs</code> 文件夹里面。笔者使用了两条初始输入： <code>helloworld</code> 以及 <code>anna</code> 。它们自身不会让程序崩溃，我们希望 AFL++ 寻找到能让程序崩溃的输入。</p>
<p>运行 AFL++：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">afl-fuzz -i inputs/ -o out/  -- ./hello
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/home/iot/test/tools/AFLplusplus/afl-fuzz -i ./fuzz_in -o ./fuzz_out -- ./hello @@
</span></span></code></pre></div><p>
<figure>
<img alt="image-20240202020635460" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/Hz24Fji7mb6s9AD.png"/>
</figure>
</p>
<p>
<figure>
<img alt="image-20240202021445446" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/BRqYnXLZ963ceyC.png"/>
</figure>
</p>
<div class="anchor" id="无源码fuzz"></div>
<h5 class="relative group">无源码fuzz： 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e6%97%a0%e6%ba%90%e7%a0%81fuzz" style="text-decoration-line: none !important;">#</a></span>
</h5>
<p>配置：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sudo apt-get install libtool-bin libgtk2.0-dev -y
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /home/iot/test/tools/AFLplusplus/qemu_mode
</span></span><span class="line"><span class="cl">./build_qemu_support.sh
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl">sudo make install
</span></span></code></pre></div><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">afl-fuzz -Q -m none -i in -o out ./pwn_file @@
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/home/iot/test/tools/AFLplusplus/afl-fuzz -i fuzz_in -o ./fuzz_out -Q ./pwn
</span></span></code></pre></div><p>
<figure>
<img alt="image-20240202034131386" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/91MyfWLrTDsS74V.png"/>
</figure>
</p>
<div class="anchor" id="satc"></div>
<h4 class="relative group">SaTC 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#satc" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p><a href="https://github.com/NSSL-SJTU/SaTC" target="_blank">
    NSSL-SJTU/SaTC: A prototype of Shared-keywords aware Taint Checking, a novel static analysis approach that tracks the data flow of the user input between front-end and back-end to precisely detect security vulnerabilities. (github.com)</a></p>
<p><strong>安装</strong></p>
<p>建议通过使用Dockerfile来构建系统环境:</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># 进入SaTC代码目录</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> SaTC 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 构建Docker镜像</span>
</span></span><span class="line"><span class="cl">docker build . -t satc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 进入Dokcer环境, 自行添加目录映射</span>
</span></span><span class="line"><span class="cl">docker run -it satc
</span></span></code></pre></div><p>如果因为网络等原因无法构建，可使用我们提供等docker image</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># 从docker hun拉去image</span>
</span></span><span class="line"><span class="cl">docker pull smile0304/satc:V1.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 进入Dokcer环境, 自行添加目录映射</span>
</span></span><span class="line"><span class="cl">docker run -it smile0304/satc:V1.0
</span></span></code></pre></div><p><strong>使用方法</strong></p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">usage</span><span class="p">:</span><span class="w"> </span><span class="n">satc</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">_ac18</span><span class="p">.</span><span class="n">extracted</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">output</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">               </span><span class="p">[</span><span class="o">--</span><span class="n">ghidra_script</span><span class="w"> </span><span class="err">{</span><span class="n">ref2sink_cmdi</span><span class="p">,</span><span class="n">ref2sink_bof</span><span class="p">,</span><span class="n">share2sink</span><span class="p">,</span><span class="n">ref2share</span><span class="p">,</span><span class="k">all</span><span class="err">}</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">               </span><span class="p">[</span><span class="o">--</span><span class="n">save_ghidra_project</span><span class="p">]</span><span class="w"> </span><span class="o">--</span><span class="n">taint_check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">               </span><span class="p">[</span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">ac18</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">httpd</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">SATC</span><span class="w"> </span><span class="n">tool</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">optional</span><span class="w"> </span><span class="n">arguments</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">-</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">help</span><span class="w">            </span><span class="err">查看帮助</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">_ac18</span><span class="p">.</span><span class="n">extracted</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">directory</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">_ac18</span><span class="p">.</span><span class="n">extracted</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="err">指定从固件中提取出的文件系统</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">output</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">output</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="err">指定结果输出位置</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">--</span><span class="n">ghidra_script</span><span class="w"> </span><span class="err">{</span><span class="n">ref2sink_cmdi</span><span class="p">,</span><span class="n">ref2sink_bof</span><span class="p">,</span><span class="n">share2sink</span><span class="p">,</span><span class="n">ref2share</span><span class="p">,</span><span class="k">all</span><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="p">(</span><span class="err">可选</span><span class="p">)</span><span class="w"> </span><span class="err">指定要使用的</span><span class="w"> </span><span class="n">Ghidra</span><span class="w"> </span><span class="err">脚本。</span><span class="w"> </span><span class="err">如果使用</span><span class="o">`</span><span class="k">all</span><span class="o">`</span><span class="err">命令，</span><span class="o">`</span><span class="n">ref2sink_cmdi</span><span class="o">`</span><span class="err">、</span><span class="o">`</span><span class="n">ref2sink_bof</span><span class="o">`</span><span class="err">和</span><span class="o">`</span><span class="n">ref2share</span><span class="o">`</span><span class="err">三个脚本将同时运行</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">--</span><span class="n">ref2share_result</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="nf">ref2share_result</span><span class="w">  </span><span class="p">(</span><span class="err">可选</span><span class="p">)</span><span class="w"> </span><span class="err">运行</span><span class="o">`</span><span class="n">share2sink</span><span class="o">`</span><span class="w"> </span><span class="n">Ghidra</span><span class="err">脚本时，需要使用该参数指定</span><span class="o">`</span><span class="n">ref2share</span><span class="o">`</span><span class="err">脚本的输出结果</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">--</span><span class="nf">save_ghidra_project</span><span class="w"> </span><span class="p">(</span><span class="err">可选</span><span class="p">)</span><span class="w"> </span><span class="err">是否保存程序运行时产生的</span><span class="n">ghidra</span><span class="err">工程路径</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">--</span><span class="nf">taint_check</span><span class="w">         </span><span class="p">(</span><span class="err">可选</span><span class="p">)</span><span class="w"> </span><span class="err">指定是否启用污点分析</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">ac18</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">httpd</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">bin</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">ac18</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nf">httpd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="p">(</span><span class="err">可选</span><span class="p">)</span><span class="w"> </span><span class="err">用于指定需要分析的程序，如果不指定，</span><span class="n">SaTC</span><span class="err">将使用内置算法确认需要分析的程序</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">len</span><span class="w"> </span><span class="mi">3</span><span class="w">         </span><span class="p">(</span><span class="err">可选</span><span class="p">)</span><span class="w"> </span><span class="err">根据分析结果分析可能为边界的前</span><span class="n">N</span><span class="err">个程序，默认为</span><span class="mi">3</span><span class="w">
</span></span></span></code></pre></div><p>
<figure>
<img alt="image-20240129012048252" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/7CAv1QNgDjKkyJG.png"/>
</figure>
</p>
<p>
<figure>
<img alt="image-20240129012209549" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/JBsi8Ev29NVmH6e.png"/>
</figure>
</p>
<p>
<figure>
<img alt="image-20240129012222971" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/CZtuy5WOvbx7wfS.png"/>
</figure>
</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sudo docker run -v /home/user/data:/data ...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo docker run -v /home/iot/test/vul:/vul ...
</span></span></code></pre></div><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1">#启动Docker容器并进入其中的交互式终端</span>
</span></span><span class="line"><span class="cl">sudo docker run -it smile0304/satc:V1.0
</span></span><span class="line"><span class="cl">sudo docker run -v /home/iot/test/vul:/vul smile0304/satc:V1.0
</span></span></code></pre></div><p>
<figure>
<img alt="image-20240129013039500" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/xNcQIo61EXWvudR.png"/>
</figure>
</p>
<p>
<figure>
<img alt="image-20240129014924286" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/UytXQcTAiYCgrMP.png"/>
</figure>
</p>
<p><strong>使用案例</strong></p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nb">cd</span> ~/SaTC/
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ~/res/
</span></span></code></pre></div><ul>
<li>分析D-Link 878中命令注入、缓冲区溢出类型的漏洞</li>
</ul>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">python satc.py -d /home/satc/dlink_878 -o /home/satc/res --ghidra_script<span class="o">=</span>ref2sink_cmdi --ghidra_script<span class="o">=</span>ref2sink_bof --taint_check
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python satc.py -d /home/satc/dlink_878 -o /home/satc/res --ghidra_script<span class="o">=</span>ref2sink_cmdi --ghidra_script<span class="o">=</span>ref2sink_bof --taint_check
</span></span></code></pre></div><ul>
<li>分析D-Link 878中<code>prog.cgi</code>命令注入类型的漏洞</li>
</ul>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">python satc.py -d /home/satc/dlink_878 -o /home/satc/res --ghidra_script<span class="o">=</span>ref2sink_cmdi -b prog.cgi --taint_check
</span></span></code></pre></div><ul>
<li>分析D-Link 878中<code>rc</code>的命令注入类型漏洞；在这个案例中<code>prog.cgi</code>中使用nvram_set设置变量，<code>rc</code>中使用nvram_get提取</li>
</ul>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">python satc.py -d /home/satc/dlink_878 -o /home/satc/res --ghidra_script<span class="o">=</span>ref2share -b prog.cgi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python satc.py -d /home/satc/dlink_878 -o /home/satc/res --ghidra_script<span class="o">=</span>share2sink --ref2share_result<span class="o">=</span>/home/satc/res/ghidra_extract_result/prog.cgi/prog.cgi_ref2share.result -b rc --taint_check
</span></span></code></pre></div><p>输出结果的目录结构为：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="p">|</span>-- ghidra_extract_result <span class="c1"># ghidra寻找函数调用路径的分析结果, 启用`--ghidra_script`选项会输出该目录</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>-- httpd <span class="c1"># 每个被分析的bin都会生成一个同名文件夹</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>       <span class="p">|</span>-- httpd <span class="c1"># 被分析的bin</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>       <span class="p">|</span>-- httpd_ref2sink_bof.result <span class="c1"># 定位bof类型的sink函数路径</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>       <span class="p">|</span>-- httpd_ref2sink_cmdi.result <span class="c1"># 定位cmdi类型的sink函数路径</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>-- keyword_extract_result  <span class="c1"># 关键字提取结果</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>-- detail  <span class="c1"># 前端关键字提取结果(详细分析结果)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>-- API_detail.result <span class="c1"># 提取的API详细结果</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>-- API_remove_detail.result <span class="c1"># 被过滤掉的API信息</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>-- api_split.result  <span class="c1"># 模糊匹配的API结果</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>-- Clustering_result_v2.result <span class="c1"># 详细分析结果(不关心其他过程关心此文件即可)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>-- File_detail.result  <span class="c1"># 记录了从单独文件中提取的关键字</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>-- from_bin_add_para.result <span class="c1"># 在二进制匹配过程中新增的关键字</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>-- from_bin_add_para.result_v2 <span class="c1"># 同上,V2版本</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>-- Not_Analysise_JS_File.result <span class="c1"># 未被分析的JS文件</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>-- Prar_detail.result <span class="c1"># 提取的Prar详细结果</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>-- Prar_remove_detail.result <span class="c1"># 被过滤掉的Prar结果</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>-- info.txt  <span class="c1"># 记录前端关键字提取时间等信息</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="p">|</span>-- simple  <span class="c1"># 前端关键字提取结果, 比较简单</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>       <span class="p">|</span>-- API_simple.result <span class="c1"># 在全部二进制中出现的全部API名称</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>       <span class="p">|</span>-- Prar_simple.result  <span class="c1"># 在全部二进制中出现等的全部Prar</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>-- result-httpd-ref2sink_cmdi-ctW8.txt <span class="c1"># 污点分析结果,启用`--taint-check` 和 `--ghidra_script`选项才会生成该文件</span>
</span></span></code></pre></div><p>在<code>/home/satc/res</code>下生成的txt文件可以查看结果</p>
<p>
<figure>
<img alt="image-20240225155906180" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/7akCFETnpudNQlm.png"/>
</figure>
</p>
<div class="anchor" id="iotseccfuzz"></div>
<h4 class="relative group">iotseccfuzz 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#iotseccfuzz" style="text-decoration-line: none !important;">#</a></span>
</h4>
<p><a href="https://github.com/securestep9/iotsecfuzz" target="_blank">
    securestep9/iotsecfuzz: fork of https://gitlab.com/invuls/iot-projects/iotsecfuzz (github.com)</a></p>
<p>安装：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">pip3 install --upgrade setuptools
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git clone https://gitlab.com/invuls/iot-projects/iotsecfuzz.git
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> iotsecfuzz
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python3 setup.py install
</span></span></code></pre></div><p>
<figure>
<img alt="img" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/m6qVihSxRjatGIl.png"/>
</figure>
</p>
<p>
<figure>
<img alt="img" class="my-0 rounded-md" src="https://s2.loli.net/2024/02/25/qLNz8OPFm2hBEoT.png"/>
</figure>
</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># API</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">isf</span> <span class="kn">import</span> <span class="n">core</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">core</span><span class="o">.</span><span class="n">init_home_directory</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># You can edit directories to load modules from</span>
</span></span><span class="line"><span class="cl"><span class="n">core</span><span class="o">.</span><span class="n">modules_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">core</span><span class="o">.</span><span class="n">load_modules</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Way 1: import the module directly</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">isf.hardware.ttltalker</span> <span class="kn">import</span> <span class="n">TTLTalker</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">talker</span> <span class="o">=</span> <span class="n">TTLTalker</span><span class="p">(</span><span class="s1">'/dev/ttyACM0'</span><span class="p">,</span> <span class="mi">9600</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">talker</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">talker</span><span class="o">.</span><span class="n">send_char</span><span class="p">(</span><span class="s1">'ff'</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Way 2: get module/submodule using ISF core</span>
</span></span><span class="line"><span class="cl"><span class="n">send_char</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">'hardware/ttltalker/send_char'</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">send_char</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">'com_port'</span><span class="p">:</span> <span class="s1">'/dev/ttyACM0'</span><span class="p">,</span> <span class="s1">'baudrate'</span><span class="p">:</span> <span class="mi">9600</span><span class="p">,</span> <span class="s1">'timeout'</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="s1">'char_hex'</span><span class="p">:</span> <span class="s1">'ff'</span><span class="p">,</span> <span class="s1">'output'</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">'output_length'</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
</span></span></code></pre></div><div class="anchor" id="其他相关工具"></div>
<h2 class="relative group">其他相关工具 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e5%85%b6%e4%bb%96%e7%9b%b8%e5%85%b3%e5%b7%a5%e5%85%b7" style="text-decoration-line: none !important;">#</a></span>
</h2>
<ul>
<li>Binwalk
<ul>
<li>misc常用</li>
</ul>
</li>
<li>Firmwalker
<ul>
<li>attify自带</li>
</ul>
</li>
<li>Angr
<ul>
<li>逆向会用</li>
</ul>
</li>
<li>gdb
<ul>
<li>pwn常用</li>
</ul>
</li>
<li>Radare2
<ul>
<li>pwn会用</li>
</ul>
</li>
<li>Binary Analysis Tool（BAT）
<ul>
<li>attify自带</li>
</ul>
</li>
<li>IDA Pro
<ul>
<li>pwn常用</li>
</ul>
</li>
<li>afl afl++等 fuzz 工具
<ul>
<li>pwn常用</li>
</ul>
</li>
<li>其他二进制静态辅助工具
<ul>
<li>BinAbsInspector</li>
<li>Rhabdomancer</li>
<li>Haruspex + semgrep</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>注：刚开始入门 IoT 时可以使用<a href="https://github.com/adi0x90/attifyos" target="_blank">
    AttifyOS v3.0</a>或者 <a href="https://github.com/AttifyOS/AttifyOS" target="_blank">
    Attify0S v4.0</a></p>
<ul>
<li>
<p>且 attifyOS 我们可以使用各类提权漏洞来切换至root用户</p>
</li>
<li>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># example1</span>
</span></span><span class="line"><span class="cl">$ sudo env /bin/bash <span class="c1"># 即可提权为root用户</span>
</span></span><span class="line"><span class="cl">$ passwd root <span class="c1"># 修改root用户的密码</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># example2 找一些cve来打</span>
</span></span><span class="line"><span class="cl">$ git clone https://github.com/blasty/CVE-2021-3156.git
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> CVE-2021-3156
</span></span><span class="line"><span class="cl">$ make
</span></span><span class="line"><span class="cl">$ chmod a+x sudo-hax-me-a-sandwich
</span></span><span class="line"><span class="cl">$ chmod +x sudo-hax-me-a-sandwich
</span></span><span class="line"><span class="cl">$ ./sudo-hax-me-a-sandwich <span class="m">0</span>
</span></span><span class="line"><span class="cl">$ passwd root
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ...</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<div class="anchor" id="参考链接"></div>
<h2 class="relative group">参考链接 
    <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
<a aria-label="锚点" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" style="text-decoration-line: none !important;">#</a></span>
</h2>
<p><a href="https://wokough.gitbook.io/iot-firmware-aio/wiki/fang-zhen-fen-xi" target="_blank">
    仿真分析 - IOT 固件安全 All in One (gitbook.io)</a></p>
<p><a href="https://iot-security.wiki/" target="_blank">
    前言 · 物联网安全百科 (iot-security.wiki)</a></p>
<p><a href="https://www.iotsec-zone.com/article/377" target="_blank">
    如何快速挖掘设备逻辑洞 - IOTsec-Zone</a></p>
<p><a href="https://www.freebuf.com/sectool/339207.html" target="_blank">
    浅析IOT二进制静态辅助方法 - FreeBuf网络安全行业门户</a></p>
<p><a href="https://www.iotsec-zone.com/article/394" target="_blank">
    Qiling Fuzz实例分析 - IOTsec-Zone</a></p>
<p><a href="https://www.iotsec-zone.com/article/249" target="_blank">
    AFL 源码分析系列（五）- afl-fuzz(2) - IOTsec-Zone</a></p>
<p><a href="https://www.iotsec-zone.com/article/245" target="_blank">
    Fuzzing101全实践 – （三） - IOTsec-Zone</a></p>
<p><a href="https://github.com/0xricksanchez" target="_blank">
    0xricksanchez (434b) (github.com)</a></p>
<p><a href="https://www.ruanx.net/author/blue/" target="_blank">
    Ruan Xingzhi - Pion1eer</a></p>
<p><a href="https://www.ruanx.net/afl-source-1/" target="_blank">
    AFL源码阅读（一）：启程 (ruanx.net)</a></p>
<p><a href="https://www.cnblogs.com/wuyida/p/6300000.html" target="_blank">
    和菜鸟一起学linux之upnp协议的学习记录 - 吴一达 - 博客园 (cnblogs.com)</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/147019829" target="_blank">
    蓝牙最详细的基础知识整理 - 知乎 (zhihu.com)</a></p>
<p><a href="https://blog.csdn.net/zwc1725/article/details/80703326" target="_blank">
    BLE 协议系列之（一） 蓝牙介绍_蓝牙是什么通信协议-CSDN博客</a></p>
<p><a href="https://cloud.tencent.com/developer/article/1913183" target="_blank">
    物联网无线短距离ZigBee技术详解-腾讯云开发者社区-腾讯云 (tencent.com)</a></p>
<details class="mt-2 mb-5 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5" style="margin-left:0px">
<summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">
        IoT学习小记 - This article is part of a series.
    </summary>
<div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        Part 1: This Article
    </div>
<div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<a href="https://ta0lve.github.io/posts/iot/0x02/">
            Part 2: IoT漏洞复现记录
        </a>
</div>
<div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<a href="https://ta0lve.github.io/posts/iot/0x03/">
            Part 3: IoT漏洞挖掘思路
        </a>
</div>
</details>
</div>
<script>
        var oid = "views_posts\\IoT\\0x01\\index.md"
        var oid_likes = "likes_posts\\IoT\\0x01\\index.md"
      </script>
<script integrity="sha512-DkmXO0rQo4LHxgEti/+CJjFmQtqrxPiiBHe9CGdPPabi+pk7wgrU9R58W7aOb5E6IHp8T+N+oOe4BolK/OCmTg==" src="/js/page.min.0e49973b4ad0a382c7c6012d8bff8226316642daabc4f8a20477bd08674f3da6e2fa993bc20ad4f51e7c5bb68e6f913a207a7c4fe37ea0e7b806894afce0a64e.js" type="text/javascript"></script>
</section>
<footer class="pt-8 max-w-prose print:hidden">
<h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
<section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
<a class="min-w-full" href="/posts/iot/0x03/">
<div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur">
<div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/iot/0x03/featured.jpg);"></div>
<div class="px-6 py-4">
<div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href="/posts/iot/0x03/">IoT漏洞挖掘思路</div>
<div class="text-sm text-neutral-500 dark:text-neutral-400">
<div class="flex flex-row flex-wrap items-center">
<time datetime="2024-02-23 00:00:00 +0000 UTC">February 23, 2024</time><span class="px-2 text-primary-500">·</span><span>3901 字</span><span class="px-2 text-primary-500">·</span><span title="预计阅读">8 分钟</span>
</div>
<div class="flex flex-row flex-wrap items-center">
<span class="mr-2" onclick="window.open(&quot;/categories/iot%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    IoT学习记录
  </span>
</span>
</span>
<span class="mr-2" onclick="window.open(&quot;/tags/iot/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    IoT
  </span>
</span>
</span>
</div>
</div>
</div>
<div class="px-6 pt-4 pb-2">
</div>
</div>
</a>
<a class="min-w-full" href="/posts/iot/0x02/">
<div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur">
<div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/iot/0x02/featured.jpg);"></div>
<div class="px-6 py-4">
<div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href="/posts/iot/0x02/">IoT漏洞复现记录</div>
<div class="text-sm text-neutral-500 dark:text-neutral-400">
<div class="flex flex-row flex-wrap items-center">
<time datetime="2024-02-22 00:00:00 +0000 UTC">February 22, 2024</time><span class="px-2 text-primary-500">·</span><time datetime="2024-02-23 00:00:00 +0000 UTC"></time><span class="px-2 text-primary-500">·</span><span>13389 字</span><span class="px-2 text-primary-500">·</span><span title="预计阅读">27 分钟</span>
</div>
<div class="flex flex-row flex-wrap items-center">
<span class="mr-2" onclick="window.open(&quot;/categories/iot%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    IoT学习记录
  </span>
</span>
</span>
<span class="mr-2" onclick="window.open(&quot;/tags/iot/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    IoT
  </span>
</span>
</span>
</div>
</div>
</div>
<div class="px-6 pt-4 pb-2">
</div>
</div>
</a>
<a class="min-w-full" href="/posts/pwn/risc-v/0x01/">
<div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative backdrop-blur">
<div class="px-6 py-4">
<div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href="/posts/pwn/risc-v/0x01/">RISC-V PWN学习</div>
<div class="text-sm text-neutral-500 dark:text-neutral-400">
<div class="flex flex-row flex-wrap items-center">
<time datetime="2023-09-03 00:00:00 +0000 UTC">September 3, 2023</time><span class="px-2 text-primary-500">·</span><span>11267 字</span><span class="px-2 text-primary-500">·</span><span title="预计阅读">23 分钟</span>
</div>
<div class="flex flex-row flex-wrap items-center">
<span class="mr-2" onclick="window.open(&quot;/categories/pwn%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    PWN学习记录
  </span>
</span>
</span>
<span class="mr-2" onclick="window.open(&quot;/tags/ctf/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    CTF
  </span>
</span>
</span>
<span class="mr-2" onclick="window.open(&quot;/tags/pwn/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    PWN
  </span>
</span>
</span>
<span class="mr-2" onclick="window.open(&quot;/tags/riscv64/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    riscv64
  </span>
</span>
</span>
<span class="mr-2" onclick="window.open(&quot;/tags/%E5%BC%82%E6%9E%84pwn/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    异构PWN
  </span>
</span>
</span>
<span class="mr-2" onclick="window.open(&quot;/tags/iot/&quot;,'_self');" style="margin-top:0.5rem">
<span class="flex">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    IoT
  </span>
</span>
</span>
</div>
</div>
</div>
<div class="px-6 pt-4 pb-2">
</div>
</div>
</a>
</section>
<div class="content" id="content">
<div style="margin-top:2em;padding:0 0.5em;font-size:.875rem">
<hr/>
<br/>
<div style="padding-bottom:1em;">
<p> </p>
<p>本文作者：<a href="https://ta0lve.github.io/about/" target="_blank"><font color="#49b1f5" style="text-decoration: underline">ta0lve</font></a></p>
<p>本文链接：<a href="https://ta0lve.github.io/posts/iot/0x01/" target="_blank"><font color="#49b1f5" style="text-decoration: underline">IoT基础学习</font></a></p>
<p><a href="https://ta0lve.github.io/posts/iot/0x01/" target="_blank"><font color="#49b1f5" style="text-decoration: underline"> https://ta0lve.github.io/posts/iot/0x01/ </font></a></p>
<p>版权声明：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank"><font color="#49b1f5" style="text-decoration: underline"> CC BY-NC 4.0 </font></a> 许可协议。</p>
<p>转载请注明来自<a class="redlink" href="https://ta0lve.github.io/" target="_blank"> <font color="#49b1f5" style="text-decoration: underline">ta0lve's Blog</font></a> ！</p>
</div>
</div>
</div>
<div class="pt-8">
<hr class="border-dotted border-neutral-300 dark:border-neutral-600"/>
<div class="flex justify-between pt-3">
<span>
<a class="flex group mr-3" href="/posts/pwn/basic/tutorial11/">
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">←</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">→</span>
<span class="flex flex-col">
<span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">CTF入门宣讲-PWN方向</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
<time datetime="2023-09-23 00:00:00 +0000 UTC">September 23, 2023</time>
</span>
</span>
</a>
</span>
<span>
<a class="flex text-right group ml-3" href="/posts/iot/0x02/">
<span class="flex flex-col">
<span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">IoT漏洞复现记录</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
<time datetime="2024-02-22 00:00:00 +0000 UTC">February 22, 2024</time>
</span>
</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">→</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">←</span>
</a>
</span>
</div>
</div>
<script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOJ9Vlo84CX_0P" data-emit-metadata="0" data-input-position="bottom" data-lang="zh-CN" data-mapping="pathname" data-reactions-enabled="1" data-repo="ta0lve/blogtalk" data-repo-id="R_kgDOJ9Vlow" data-strict="0" data-theme="dark_dimmed" src="https://giscus.app/client.js">
</script>
</footer>
</article>
<div class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0" id="top-scroller">
<a aria-label="" class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" href="#the-top" title="">
    ↑
  </a>
</div>
</main><footer class="py-10 print:hidden" id="site-footer">
<nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
<ul class="flex flex-col list-none sm:flex-row">
<li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/about/" title="About">About</a>
</li>
<li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/tags/pwn/" title="PWN">pwn2own , pwn4fun</a>
</li>
</ul>
</nav>
<div class="flex items-center justify-between">
<p class="text-sm text-neutral-500 dark:text-neutral-400">
      Copyright ©2024 ta0lve, All Rights Reserved.
    </p>
<p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      由 <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://blowfish.page/" rel="noopener noreferrer" target="_blank">Blowfish</a> 强力驱动
    </p>
</div>
<script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
<script integrity="sha512-NcERO8wWxaWb8DEIL55jgiqpUoBCOIGnhHp/8zoW5imc5qhA2e9OENlH4DChjz8gNZr7LsDzWWdIS5qTYKwxRQ==" src="/js/process.min.35c1113bcc16c5a59bf031082f9e63822aa95280423881a7847a7ff33a16e6299ce6a840d9ef4e10d947e030a18f3f20359afb2ec0f35967484b9a9360ac3145.js" type="text/javascript"></script>
</footer><div class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url="https://ta0lve.github.io/" id="search-wrapper" style="z-index:500">
<div class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800" id="search-modal">
<header class="relative z-10 flex items-center justify-between flex-none px-2">
<form class="flex items-center flex-auto min-w-0">
<div class="flex items-center justify-center w-8 h-8 text-neutral-400">
<span class="relative block icon">
<svg aria-hidden="true" class="svg-inline--fa fa-search fa-w-16" data-icon="search" data-prefix="fas" focusable="false" role="img" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z" fill="currentColor"></path></svg>
</span>
</div>
<input class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" id="search-query" placeholder="" tabindex="0" type="search"/>
</form>
<button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" id="close-search-button" title="">
<span class="relative block icon">
<svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z" fill="currentColor"></path></svg>
</span>
</button>
</header>
<section class="flex-auto px-2 overflow-auto">
<ul id="search-results">
</ul>
</section>
</div>
</div>
</div>
</body>
</html>
